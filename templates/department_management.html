<!doctype html>
<html>
<head>
  <link rel="icon" href="{{ assets_url }}/favicon.ico" sizes="16">
  <link rel="stylesheet" href="{{ assets_url }}/stylesheets/common.css">
  <link rel="stylesheet" href="{{ assets_url }}/stylesheets/department_management.css">
  <title>Department Management</title>
  <script>
    function switch_value_input(property) {
      var value_id = "";
      value_id = property.concat("_value");
      var input_id = "";
      input_id = property.concat("_input");
      var focus_id = "";
      focus_id = property.concat("_focus");
      if (document.getElementById(value_id).style.display == "none") {
        document.getElementById(value_id).style.display = "grid";
        document.getElementById(input_id).style.display = "none";
      } else {
        document.getElementById(value_id).style.display = "none";
        document.getElementById(input_id).style.display = "grid";
        document.getElementById(focus_id).focus();
      }
    }
  </script>
</head>
<body>
  <div class="sidebar">
    <div class="logo">
      <img src="{{ assets_url }}/logo.png" style="width:100%">
    </div>
    <div class="menu">
      <div>
        <form class="menu" method="post"><button class="menu" type="submit" name="function" value="department_list">Departments</button></form>
      </div>
      <div>
        <form class="menu" method="post"><button class="menu" type="submit" name="function" value="inventory_management">Inventory</button></form>
      </div>
      <div>
        <form method="post"><button class="menu" type="submit" name="function" value="admin">Admin</button></form>
      </div>
      <div>
        <form method="post"><button class="menu" type="submit" name="function" value="main_menu">Main Menu</button></form>
      </div>
      <div>
        <form method="post"><button class="menu" type="submit" name="function" value="log_out">Log Out</button></form>
      </div>
    </div>
  </div>
  <div class="mainbody">
    <h1>Department Management</h1>
    {% if message %}<h3>{{ message|safe }}</h3>{% endif %}

    <div class="department">
      <div class="department_info">
        <div class="department_key">Department Name:</div>
        <div class="department_value" id="department_id_value">{{ department_document['department_id'] }}</div>
        <div class="department_key"><button class="key" onclick="switch_value_input('default_margin')">Default Margin:</button></div>
        <div class="department_value" id="default_margin_value">{{ (department_document['default_margin'] * 100)|round(5) }}%</div>
        <div class="department_input" id="default_margin_input">

          <form method="post">
            <input id="default_margin_focus" type="text" class="department" title="Enter a percentage" name="default_margin">
            <input type="submit" name="function" value="set_default_margin" hidden>
            <input type="hidden" name="department_id" value="{{ department_document['department_id'] }}">
          </form>
          
        </div>
        <div class="department_key"><button class="key" onclick="switch_value_input('default_employee_discount')">Default Employee Discount:</button></div>
        <div class="department_value" id="default_employee_discount_value">{{ (department_document['default_employee_discount'] * 100)|round(5) }}%</div>
        <div class="department_input" id="default_employee_discount_input">

          <form method="post">
            <input id="default_employee_discount_focus" type="text" class="department title="Enter a percentage" name="default_employee_discount">
            <input type="submit" name="function" value="set_default_employee_discount" hidden>
            <input type="hidden" name="department_id" value="{{ department_document['department_id'] }}">
          </form>
        </div>
        <div class="department_key"><button class="key" onclick="switch_value_input('default_food_item')">Default Food Item:</button></div>
        <div class="department_value" id="default_food_item_value">{{ department_document['default_food_item'] }}</div>
        <div class="department_input" id="default_food_item_input">
          <form method="post">
            <select id="default_food_item_focus" name="default_food_item">
              <option value="True">True</option>
              <option value="False">False</option>
            </select>
            <button type="submit" name="function" value="set_default_food_item">OK</button>
            <input type="hidden" name="department_id" value="{{ department_document['department_id'] }}">
          </form>
        </div>
        <div class="department_key"><button class="key" onclick="switch_value_input('default_ebt_eligible')">Default EBT Eligible:</button></div>
        <div class="department_value" id="default_ebt_eligible_value">{{ department_document['default_ebt_eligible'] }}</div>
        <div class="department_input" id="default_ebt_eligible_input">
          <form method="post">
            <select id="default_ebt_eligible_focus" name="default_ebt_eligible">
              <option value="True">True</option>
              <option value="False">False</option>
            </select>
            <button type="submit" name="function" value="set_default_ebt_eligible">OK</button>
            <input type="hidden" name="department_id" value="{{ department_document['department_id'] }}">
          </form>
        </div>
      </div>
      {% for location in department_document['location_defaults'] %}
      <div class="location" >
        <div class="location_info">
          <div class="location_heading">{{ location['location_id'] }}</div>
          <div class="location_key"><button class="key" onclick="switch_value_input('{{ location['location_id'] }}_default_online_ordering')">Default Online Ordering:</button></div>
          <div class="location_value" id="{{ location['location_id'] }}_default_online_ordering_value">{{ location['default_online_ordering'] }}</div>
          <div class="location_input" id="{{ location['location_id'] }}_default_online_ordering_input">
            <form method="post">
              <select name="default_online_ordering" id="{{ location['location_id'] }}_default_online_ordering_focus">
                <option value="yes">Yes</option>
                <option value="member">Member</option>
                <option value="no">No</option>
              </select>
              <button type="submit" name="function" value="set_default_online_ordering">OK</button>
              <input type="hidden" name="department_id" value="{{ department_document['department_id'] }}">
              <input type="hidden" name="location_id" value="{{ location['location_id'] }}">
            </form>
          </div>
        </div>
        <div class="tax_info">
          <div class="tax_heading">Default Taxes:</div>
          {% for tax in location['available_taxes'] %}
          <div class="tax">
            <div class="tax_id"><button class="key" onclick="switch_value_input('{{ location['location_id'] }}_{{ tax }}')">{{ tax }}:</button></div>
            <div class="tax_default" id="{{ location['location_id'] }}_{{ tax }}_value">{% if tax in location['default_taxes'] %}on{% else %}off{% endif %}</div>
            <div class="tax_input" id="{{ location['location_id'] }}_{{ tax }}_input">
              <form method="post">
                {% if tax in location['default_taxes'] %}                
                <button type="submit" name="function" value="remove_tax">Remove</button>
                {% else %}
                <button type="submit" name="function" value="add_tax">Add</button>
                {% endif %}
                <input type="hidden" name="department_id" value="{{ department_document['department_id'] }}">
                <input type="hidden" name="location_id" value="{{ location['location_id'] }}">
                <input type="hidden" name="tax_id" value="{{ tax }}">
              </form>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endfor %}
      <div class="categories">
        <div class="categories_header"><button class="key" onclick="switch_value_input('categories')">Categories:</button></div>      
        <div class="add_category_value" id="categories_value">Select to view and add subcategories</div>
        <div class="add_category" id="categories_input">
          <form method="post">
            <div class="category_input">
              <div class="category_name"id="categories_focus"><input type="text" class="category" title="Enter a category" name="category_id"></div>
              <div class="category_button"><button type="submit" name="function" value="add_category">Add</button></div>
              <input type="hidden" name="department_id" value="{{ department_document['department_id'] }}">
            </div>
          </form>
        </div>
        {% for category in categories_list %}
        <div class="category">
          <form method="post">
            <div class="category_button">
              <button class="category" type="submit" name="function" value="go_to_category">{{ category['category_id'] }}</button>
              
            </div>
            <input type="hidden" name="category_id" value="{{ category['category_id'] }}">
          </form>
          
        </div>
        {% endfor %}
      </div>
    </div>

    
  
  </div>
</body>
</html>
