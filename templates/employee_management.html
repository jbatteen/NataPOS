<!doctype html>
<html>
<head>
  <link rel="icon" href="{{ assets_url }}/favicon.ico" sizes="16">
  <link rel="stylesheet" href="{{ assets_url }}/stylesheets/common.css">
  <link rel="stylesheet" href="{{ assets_url }}/stylesheets/employee_management.css">
  <title>employee Management</title>
  <script>
    function switch_value_input(property) {
      var value_id = "";
      value_id = property.concat("_value");
      var input_id = "";
      input_id = property.concat("_input");
      var focus_id = "";
      focus_id = property.concat("_focus");
      if (document.getElementById(value_id).style.display == "none") {
        document.getElementById(value_id).style.display = "grid";
        document.getElementById(input_id).style.display = "none";
      } else {
        document.getElementById(value_id).style.display = "none";
        document.getElementById(input_id).style.display = "grid";
        document.getElementById(focus_id).focus();
      }
    }
    function switch_visible(property) {
      var input_id = "";
      input_id = property.concat("_input");
      var focus_id = "";
      focus_id = property.concat("_focus");
      if (document.getElementById(input_id).style.display != "grid") {
        document.getElementById(input_id).style.display = "grid";
        document.getElementById(focus_id).focus();
      } else {
        document.getElementById(input_id).style.display = "none";
      }
    }
  </script>
</head>
<body>
  <div class="sidebar">
    <img src="{{ assets_url }}/logo.png" class="sidebarlogo">
    <form method="post" class="menu">
      <button class="menu" type="submit" name="function" value="admin">Admin</button>
      <button class="menu" type="submit" name="function" value="main_menu">Main Menu</button>
      <button class="menu" type="submit" name="function" value="log_out">Log Out</button>
    </form>
  </div>
  <div class="mainbody">
    <h1>Employees</h1>
    {% if message %}<h3>{{ message|safe }}</h3>{% endif %}
    <div class="employee_list">
      {% for i in employee_collection %}
      <div class="employee">

        <span class="employee_key">Username:</span>
        <span class="employee_value">{{ i['username'] }}</span>
        
        <button class="key" onclick="switch_value_input('{{ i['username'] }}_name')">Name:</button>
        <span class="employee_value" id="{{ i['username'] }}_name_value" style="width:fit-content">{{ i['name'] }}</span>
        <form method="post" class="employee_input" id="{{ i['username'] }}_name_input">
          <input type="text" class="wide" title="Enter employee name" name="name" id="{{ i['username'] }}_name_focus">
          <input type="hidden" name="username" value="{{ i['username'] }}">
          <input type="submit" name="function" value="change_name" hidden>
        </form>
        
        <button class="key" onclick="switch_value_input('{{ i['username'] }}_short_name')">Short Name:</button>
        <span class="employee_value" id="{{ i['username'] }}_short_name_value" style="width:fit-content">{{ i['short_name'] }}</span>
        <form method="post" class="employee_input" id="{{ i['username'] }}_short_name_input">
          <input type="text" class="wide" title="Enter a short name for receipts" name="short_name" id="{{ i['username'] }}_short_name_focus">
          <input type="hidden" name="username" value="{{ i['username'] }}">
          <input type="submit" name="function" value="change_short_name" hidden>
        </form>
        
        <button class="key" onclick="switch_value_input('{{ i['username'] }}_title')">Title:</button>
        <span class="employee_value" id="{{ i['username'] }}_title_value" style="width:fit-content">{{ i['title'] }}</span>
        <form method="post" class="employee_input" id="{{ i['username'] }}_title_input">
          <input type="text" class="wide" title="Enter a title" name="title" id="{{ i['username'] }}_title_focus">
          <input type="hidden" name="username" value="{{ i['username'] }}">
          <input type="submit" name="function" value="change_title" hidden>
        </form>
        
        <button class="key" onclick="switch_value_input('{{ i['username'] }}_phone')">Phone:</button>
        <span class="employee_value" id="{{ i['username'] }}_phone_value">{{ i['phone'] }}</span>
        <form method="post" class="employee_input" id="{{ i['username'] }}_phone_input">
          <input type="text" class="wide" title="Enter a phone number" name="phone" id="{{ i['username'] }}_phone_focus">
          <input type="hidden" name="username" value="{{ i['username'] }}">
          <input type="submit" name="function" value="change_phone" hidden>
        </form>
        
        <button class="key" onclick="switch_value_input('{{ i['username'] }}_address')">Address:</button>
        <span class="employee_value" id="{{ i['username'] }}_address_value">{{ i['address'] }}</span>
        <form method="post" class="employee_input" id="{{ i['username'] }}_address_input">
          <input type="text" class="wide" title="Enter an address" name="address" id="{{ i['username'] }}_address_focus">
          <input type="hidden" name="username" value="{{ i['username'] }}">
          <input type="submit" name="function" value="change_address" hidden>
        </form>
        
        <button class="key" onclick="switch_value_input('{{ i['username'] }}_email')">Email:</button>
        <span class="employee_value" id="{{ i['username'] }}_email_value">{{ i['email'] }}</span>
        <form method="post" class="employee_input" id="{{ i['username'] }}_email_input">
          <input type="text" class="wide" title="Enter an email address" name="email" id="{{ i['username'] }}_email_focus">
          <input type="hidden" name="username" value="{{ i['username'] }}">
          <input type="submit" name="function" value="change_email" hidden>
        </form>
        
        <button class="key" onclick="switch_value_input('{{ i['username'] }}_hire_date')">Hire Date:</button>
        <span class="employee_value" id="{{ i['username'] }}_hire_date_value">{{ i['hire_date'] }}</span>
        <form method="post" class="employee_input" id="{{ i['username'] }}_hire_date_input">
          <input type="text" class="wide" title="Enter a contact name" name="hire_date" id="{{ i['username'] }}_hire_date_focus">
          <input type="hidden" name="username" value="{{ i['username'] }}">
          <input type="submit" name="function" value="change_hire_date" hidden>
        </form>
        
        <button class="key" onclick="switch_value_input('{{ i['username'] }}_status')">Status:</button>
        <span class="employee_value" id="{{ i['username'] }}_status_value">{{ i['status'] }}</span>
        <form method="post" class="status_form" id="{{ i['username'] }}_status_input">
          <input type="hidden" name="username" value="{{ i['username'] }}">
          <select name="status" id="{{ i['username'] }}_status_focus">
            <option value="current">Current</option>
            <option value="former">Former</option>
          </select>
          <button style="width:fit-content" type="submit" name="function" value="change_status">OK</button>
        </form>
        
        <button class="key" onclick="switch_value_input('{{ i['username'] }}_login_message')">Login Message:</button>
        <span class="employee_value" id="{{ i['username'] }}_login_message_value" style="width:fit-content">{{ i['login_message'] }}</span>
        <form method="post" class="employee_input" id="{{ i['username'] }}_login_message_input">
          <input type="text" class="wide" title="Enter a message to be displayed at login" name="login_message" id="{{ i['username'] }}_login_message_focus">
          <input type="hidden" name="username" value="{{ i['username'] }}">
          <input type="submit" name="function" value="change_login_message" hidden>
        </form>
        
        <button class="key" onclick="switch_visible('{{ i['username'] }}_reset_password')">Reset Password:</button>
        <form method="post" class="reset_password_form" id="{{ i['username'] }}_reset_password_input">
          <input type="hidden" name="username" value="{{ i['username'] }}">
          <label for="{{ i['username'] }}_reset_password_focus">Password:</label><input id="{{ i['username'] }}_reset_password_focus" type="password" class="password" title="Enter a password" name="password1">
          <label for="reset_password2">Verify:</label><input id="reset_password_2" type="password" class="password" title="Enter a password" name="password2">
          <button style="width:fit-content" type="submit" name="function" value="reset_password">OK</button>
        </form>

        <form method="post" class="permission_form">
          <input type="hidden" name="username" value="{{ i['username'] }}">
          <input id="{{ i['username'] }}_inventory_management" type="checkbox" name="permissions[]" value="inventory_management" {% if 'inventory_management' in i['permissions'] %}checked{% else %}unchecked{% endif %} /><label for="{{ i['username'] }}_inventory_management">Inventory Management</label>
          <input id="{{ i['username'] }}_suppliers_departments_brands" type="checkbox" name="permissions[]" value="suppliers_departments_brands" {% if 'suppliers_departments_brands' in i['permissions'] %}checked{% else %}unchecked{% endif %} /><label for="{{ i['username'] }}_suppliers_departments_brands">Suppliers, Departments, Brands</label>
          <input id="{{ i['username'] }}_employee_management" type="checkbox" name="permissions[]" value="employee_management" {% if 'employee_management' in i['permissions'] %}checked{% else %}unchecked{% endif %} /><label for="{{ i['username'] }}_employee_management">Employee Management</label>
          <input id="{{ i['username'] }}_shrink" type="checkbox" name="permissions[]" value="shrink" {% if 'shrink' in i['permissions'] %}checked{% else %}unchecked{% endif %} /><label for="{{ i['username'] }}_shrink">Shrink Items</label>
          {% if 'superuser' in permissions %}<input id="{{ i['username'] }}_superuser" type="checkbox" name="permissions[]" value="superuser" {% if 'superuser' in i['permissions'] %}checked{% else %}unchecked{% endif %} /><label for="{{ i['username'] }}_superuser">Superuser</label>{% endif %}

          <button style="width:fit-content" type="submit" name="function" value="modify_permissions">Modify Permissions</button>
        </form>
        {% if 'superuser' in permissions %}
        <form method="post" class="delete_button">
          <input type="hidden" name="username" value="{{ i['username'] }}">
          <button class="change" type="submit" name="function" value="delete_employee">Delete</button>
        </form>
        {% endif %}
      </div>
      {% endfor %}

      <div class="new_employee">
        <button class="create_employee" onclick="switch_visible('create_employee')">Create a New employee:</button>
        <form method="post" class="create_employee_input" id="create_employee_input">

          <span class="new_employee_key">Username:</span><input type="text" id="create_employee_focus" class="wide" title="Enter a username for the employee" name="username">
          <span class="new_employee_key">Password:</span><input type="password" class="wide" title="Enter a password" name="password1">
          <span class="new_employee_key">Verify Password:</span><input type="password" class="wide" title="Enter a password" name="password2">
          <span class="new_employee_key">Full Name:</span><input type="text" class="wide" title="Enter the full name" name="name">
          <span class="new_employee_key">Short Name:</span><input type="text" class="wide" title="Enter a short name " name="short_name">
          <span class="new_employee_key">Title:</span><input type="text" class="wide" title="Enter a title" name="title">
          <span class="new_employee_key">Phone:</span><input type="text" class="wide" title="Enter a phone number" name="phone">
          <span class="new_employee_key">Address:</span><input type="text" class="wide" title="Enter an address" name="address">
          <span class="new_employee_key">Email:</span><input type="text" class="wide" title="Enter an email address" name="email">
          <span class="new_employee_key">Hire Date:</span><input type="text" class="wide" title="Enter a hire date" name="hire_date">
          <span class="new_employee_key">Login Message:</span><input type="text" class="wide" title="Enter a message to be displayed at login" name="login_message">
          <div class="permissions">
            <input id="inventory_management" type="checkbox" name="permissions[]" value="inventory_management" unchecked /><label for="inventory_management">Inventory Management</label>
            <input id="suppliers_departments_brands" type="checkbox" name="permissions[]" value="suppliers_departments_brands" unchecked /><label for="suppliers_departments_brands">Suppliers Departments Brands</label>
            <input id="employee_management" type="checkbox" name="permissions[]" value="employee_management" unchecked /><label for="employee_management">Employee Management</label>
            <input id="shrink" type="checkbox" name="permissions[]" value="shrink" unchecked /><label for="shrink">Shrink Items</label>
            {% if 'superuser' in permissions %}<input id="superuser" type="checkbox" name="permissions[]" value="superuser" unchecked /><label for="superuser">Superuser</label>{% endif %}
          </div>

          <button style="width:fit-content" type="submit" name="function" value="create_employee">Create</button>

        </form>
      </div>
    </div>
  
  </div>
</body>
</html>
